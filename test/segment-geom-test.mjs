import api from '../mapshaper.js';
import assert from 'assert';
import { findCrossIntersection_robust } from '../src/geom/mapshaper-segment-geom';
import { findCrossIntersection_big } from '../src/geom/mapshaper-segment-geom-big';

var internal = api.internal;
var geom = api.geom,
    ArcCollection = internal.ArcCollection;

describe('mapshaper-segment-geom.js', function () {

  describe('segmentTurn()', function () {

    it('left turn', function () {
      var pp = [[0, 0], [0, 1], [2, 2], [1, 2]];
      assert.equal(geom.segmentTurn.apply(null, pp), -1);
    })
    it('right turn', function () {
      var pp = [[0, 0], [0, 1], [1, 2], [2, 2]];
      assert.equal(geom.segmentTurn.apply(null, pp), 1);
    })
    it('collinear', function () {
      var pp = [[0, 0], [0, 1], [2, 2], [2, 3]];
      assert.equal(geom.segmentTurn.apply(null, pp), 0);
    })
    it('collinear 2', function () {
      var pp = [[0, 0], [0, 1], [2, 2], [2, 1]];
      assert.equal(geom.segmentTurn.apply(null, pp), 0);
    })
  })


  describe('Tests based on real data', function () {
    return;
    // REMOVING THIS TEST --- no longer detecting both T-intersections and crosses
    it('Data from clean/ex7_britain.json -- T-intersection and cross', function() {
      /*
      arc 2
      i1  42
      i2  43
      x1  413730.38500158896
      y1  289723.21580549097
      x2  414248.4061214699
      y2  290157.18802885344

      arc 1
      i1  29
      i2  30
      x1  414248.4061220713
      y1  290157.1880293601
      x2  413730.38500161114
      y2  289723.21580549626
      */

      var a = [413730.38500158896, 289723.21580549097];
      var b = [414248.4061214699, 290157.18802885344]; // ....
      var c = [414248.4061220713, 290157.1880293601];
      var d = [413730.38500161114, 289723.21580549626];
      var hit = geom.segmentIntersection(a[0], a[1], b[0], b[1], c[0], c[1], d[0], d[1]);
      // Two hits: a T-intersection and a cross
      assert.equal(hit.length, 4);
    });

    it('Data from polygons/ex1.shp -- Collinear segments with one shared endpoint', function() {
      /*
      arc 6
      i1  26
      i2  27
      x1  13.3113098
      y1  38.1946564
      x2  13.3092499
      y2  38.1946564

      arc 11
      i1  71
      i2  72
      x1  13.3113098
      y1  38.1946564
      x2  13.3106232
      y2  38.1946564
      */
      var a = [13.3113098, 38.1946564],
          b = [13.3092499, 38.1946564],
          c = [13.3113098, 38.1946564],
          d = [13.3106232, 38.1946564];
      var hit = geom.segmentIntersection(a[0], a[1], b[0], b[1], c[0], c[1], d[0], d[1]);
      assert.deepEqual(hit, [13.3106232, 38.1946564]); // only interior endpoint is detected as point of intersection
    });

  })

  describe('segmentHit_fast', function () {
    it('detects collinear horizontal overlapping segments', function () {
      assert(geom.segmentHit_fast(0, 0, 3, 0, 1, 0, 4, 0));
      assert(geom.segmentHit_fast(0, 0, 3, 0, 1, 0, 2, 0));
      assert(geom.segmentHit_fast(0, 0, 3, 0, 0, 0, 2, 0));
    })
    it('detects collinear vertical overlapping segments', function () {
      assert(geom.segmentHit_fast(0, 0, 0, 3, 0, 1, 0, 4));
      assert(geom.segmentHit_fast(0, 0, 0, 3, 0, 1, 0, 2));
      assert(geom.segmentHit_fast(0, 0, 0, 3, 0, 0, 0, 2));
    })
    it('detects collinear sloping overlapping segments', function () {
      assert(geom.segmentHit_fast(0, 0, 3, 3, 1, 1, 4, 4));
      assert(geom.segmentHit_fast(0, 0, 3, 3, 1, 1, 2, 2));
      assert(geom.segmentHit_fast(0, 0, 3, 3, 1, 1, 2, 2));
    })
    it('rejects collinear disjoint segments', function () {
      assert(geom.segmentHit_fast(0, 0, 1, 1, 3, 3, 4, 4));
      assert(geom.segmentHit_fast(0, 0, 0, 1, 0, 2, 0, 4));
      assert(geom.segmentHit_fast(0, 0, 1, 0, 3, 0, 4, 0));
    })
  })

  describe('segmentIntersection', function () {
    it('Joined segs are not intersections', function () {
      assert.equal(geom.segmentIntersection(0, 0, 0, 1, 0, 1, 1, 1), null)
      assert.equal(geom.segmentIntersection(0, 0, 0, 1, 0, 1, 0, 2), null)
      assert.equal(geom.segmentIntersection(0, 0, 0, 1, 1, 0, 0, 0), null)
      assert.equal(geom.segmentIntersection(0, 0, 0, 1, 0, 0, 1, 0), null)
      assert.equal(geom.segmentIntersection(0, 0, 1, 1, 1, 1, 2, 0), null)
      assert.equal(geom.segmentIntersection(0, 0, 1, 1, 1, 1, 2, 2), null)
      assert.equal(geom.segmentIntersection(0, 0, 1, -1, 1, -1, 2, 0), null)
    });

    it('Congruent segments are nully', function() {
      assert.equal(geom.segmentIntersection(0, 0, 1, 1, 0, 0, 1, 2), null)
      assert.equal(geom.segmentIntersection(1, 2, 0, 0, 0, 0, 1, 1), null)
      assert.equal(geom.segmentIntersection(0, 0, 1, 0, 1, 0, 0, 0), null)
      assert.equal(geom.segmentIntersection(0, 1, 0, 0, 0, 1, 0, 0), null)
    })

    it('Partially congruent segments are treated as having one or two intersections', function() {
      assert.deepEqual(geom.segmentIntersection(0, 0, 1, 1, 0, 0, 2, 2), [1, 1])
      assert.deepEqual(geom.segmentIntersection(2, 2, 0, 0, 0, 0, 1, 1), [1, 1])
      assert.deepEqual(geom.segmentIntersection(3, 3, 0, 0, 2, 2, 1, 1), [2, 2, 1, 1])
      assert.deepEqual(geom.segmentIntersection(0, 0, 2, 2, 1, 1, 3, 3), [2, 2, 1, 1])
      assert.deepEqual(geom.segmentIntersection(0, 3, 0, 0, 0, 2, 0, 1), [0, 2, 0, 1])
      assert.deepEqual(geom.segmentIntersection(0, 0, 0, 2, 0, 1, 0, 3), [0, 2, 0, 1])
      assert.deepEqual(geom.segmentIntersection(3, 0, 0, 0, 2, 0, 1, 0), [2, 0, 1, 0])
      assert.deepEqual(geom.segmentIntersection(0, 0, 2, 0, 1, 0, 3, 0), [2, 0, 1, 0])
   })

    it('Tiny overlaps are detected', function() {
      var TINY = 0.00000000001;
      assert.equal(!!geom.segmentIntersection(0, 0, 1, 1, TINY, 0, 1 - TINY, 1), true);
      assert.equal(!!geom.segmentIntersection(TINY, 0, 1, 1, 0, 0, 1, TINY), true);
      assert.equal(!!geom.segmentIntersection(0, 0, 1, -1, TINY, 0, 1 - TINY, -1), true);
      assert.equal(!!geom.segmentIntersection(TINY, 0, 1, -1, 0, 0, 1, -TINY), true);
    })
  })

  describe('findCrossIntersection_robust() tests', function() {
    it ('comparisons with findCrossIntersection_big()', function() {
      function compare(arr, i) {
        var p = findCrossIntersection_robust.apply(null, arr);
        var p2 = findCrossIntersection_big.apply(null, arr);
        assert.deepEqual(p, p2);
      }
      var data = [
[-118.95970398142646,34.82303900288796,-118.95937600803153,34.82308999875119,-118.95970263536432,34.82303921181264,-118.95937600449595,34.8230899994812],
[-118.94462899702,34.82383999938652,-118.94462899100918,34.823839998706795,-118.94462899580303,34.82383999938089,-118.94433700377358,34.82379800052734],
[-118.925247,34.821334,-118.92504900125397,34.82136599979734,-118.92524699995482,34.821333999719016,-118.92504900295482,34.82136599971901],
[-118.93461999848084,34.824516008070475,-118.93460500266919,34.82464498045066,-118.93461999799999,34.824516008,-118.93461999733074,34.82451601955002],
[-118.86521429235135,34.83282883121752,-118.86513198376979,34.83291099969679,-118.86517230734971,34.83287074422898,-118.86513194259717,34.83291104099035],
[-118.22901575059437,34.83460967300082,-118.22024328902373,34.834645256974746,-118.22775319640562,34.834614794999176,-118.22024327040522,34.834645256999174],
[-118.86401099504663,34.83563000372201,-118.86396100467084,34.8356679964876,-118.86401098750804,34.83563000961644,-118.86396100950805,34.835667992616436],
[-119.1557729928105,34.85223099933611,-119.15577297890528,34.8522310009287,-119.15577299123747,34.852231000156834,-119.15561401760168,34.85223799909677],
[-118.92205999171021,34.85101699565851,-118.92200401327864,34.850989006442724,-118.922059988722,34.8510169945576,-118.92200400731828,34.85098900335576],
[-118.55263599678476,34.84960000033803,-118.55143500478476,34.849698999338024,-118.55244735721529,34.849615549661976,-118.55143500121528,34.849698999661975],
[-118.53377299257112,34.851362008850245,-118.53369500672085,34.85146499137042,-118.53377299127963,34.85136201162896,-118.53369500308236,34.85146499556895],
[-118.20255405835056,34.85443384509991,-118.20253719406304,34.85282991386359,-118.202554058,34.854433854,-118.202540238,34.853119381],
[-118.92634963354679,34.86040193202522,-118.9262850285468,34.86043498502522,-118.92634962145274,34.86040193797501,-118.9262850135684,34.86043499286935],
[-118.23028800615234,34.86362492413907,-118.23028799900128,34.863624887505,-118.23028799997095,34.863624980998125,-118.23028399999873,34.86283309549489],
[-118.45025390602224,34.88264151613572,-118.45025389950665,34.88264152151061,-118.45025390272384,34.88264151903582,-118.44914000197778,34.88339399886428],
[-118.44686599815739,34.88495701095459,-118.4468300020704,34.88512998876171,-118.4468300030973,34.88512998362697,-118.44683000141069,34.885129994946396],
[-118.44697699878488,34.88604299712685,-118.44689300054061,34.885732000924946,-118.44689300283267,34.88573200470404,-118.44689300145936,34.885732005074956],
[-118.72970999161036,34.898705005084764,-118.72922401129041,34.89901999305139,-118.72922402238957,34.89901998591528,-118.72922401272136,34.89901999144272],
[-118.72922399472162,34.8990200004426,-118.72922397601909,34.89902000755573,-118.72922398631202,34.8990200039719,-118.72827402998077,34.899275992444316],
[-118.42049098775021,34.90611100004052,-118.4181700003786,34.90614299999049,-118.4204909746214,34.9061110000095,-118.41816999971206,34.90614300000826],
[-118.84186898710054,34.930166985987256,-118.84005600013131,34.92818000040488,-118.84186897387109,34.93016697159776,-118.8400559998711,34.92817999959776],
[-118.92336199981862,34.93011199903018,-118.92320400081863,34.92985900103018,-118.9233619981812,34.93011199796955,-118.92320400218121,34.92985900296955],
[-118.36149774924219,34.92907478167861,-118.36140800328366,34.92913199837709,-118.36140800823796,34.92913199505625,-118.36140800461384,34.92913199782434],
[-118.962282355,34.94062813419082,-118.96197551362988,34.93582457605134,-118.96228235478388,34.94062813615187,-118.96197551710748,34.9358246268652],
[-118.8448229926659,34.941906976004475,-118.84468200014469,34.94142400149565,-118.84482297400672,34.941906911023,-118.84468200000671,34.941424002023],
[-118.32771999893951,34.95493395752244,-118.327697,34.954273005260575,-118.32769700077222,34.95427299559648,-118.32769700006048,34.954273011477454],
[-118.3074239952536,34.97457800150738,-118.30721831998352,34.97462864925459,-118.30742399237725,34.97457800213166,-118.30742399133165,34.97457800256476],
[-118.28887800414552,34.98941499864875,-118.28887799685448,34.98941500178656,-118.28887799735654,34.98941500154729,-118.28768200133318,34.98998699964542],
[-118.02782399923723,34.99985900002772,-118.02345901350134,34.99897900229059,-118.023459021,34.998979004,-118.023459018,34.998979003],
[-118.26376300005315,35.0029100001603,-118.26376299223071,35.00291000406748,-118.26376299717492,35.002910001296705,-118.26365328917493,35.0029730462967],
[-118.4164120639988,35.00821014350992,-118.4163566349988,34.996900066509916,-118.41641206371165,35.00821014301608,-118.41635359402042,34.99627949608386],
[-118.06042781700022,35.02460837820825,-118.06040278500022,35.012588031208246,-118.06041383099978,35.01789235179175,-118.060402785,35.012588030894115],
[-118.04254632761564,35.02189763199001,-118.03224725735642,35.02030816503913,-118.03224725864878,35.02030816523848,-118.03224725864399,35.020308165269554],
[-119.064911996,35.024913991,-119.064911992,35.024913973,-119.06491199586769,35.02491398674157,-119.06476440586292,35.024440448778385],
[-118.05172599988545,35.022042000215045,-118.051718,35.02187500360604,-118.05172599899369,35.022041978993,-118.05172599836725,35.022041986258415],
[-118.25164100066605,35.03479399891258,-118.25157587309539,35.034854242590434,-118.25162498592564,35.034808812719874,-118.25156499630879,35.03486430341437],
[-117.88114699498036,35.04442598058438,-117.88109400151988,35.044221005878775,-117.88114699,35.044425961,-117.881094003,35.044221012],
[-118.18920829426341,35.053292079002716,-118.18840601016774,35.05329799996652,-118.188406017,35.053298,-118.18840600869548,35.053297999654575],
[-119.4139809992601,35.05465797991009,-119.41387600074651,35.05180702026938,-119.41398099593225,35.05465788331955,-119.4139809924764,35.0546579133117],
[-118.24453899846897,35.05382999999121,-118.24445400357686,35.053828406317066,-118.24446399642314,35.05382859368293,-118.24437899990488,35.05382700001776],
[-117.777404994,35.058477999,-117.776085003,35.058543999,-117.77729452900638,35.05848352212475,-117.77608500500618,35.05854399912477],
[-117.76715610867716,35.06098978198399,-117.76712900267717,35.06087500498399,-117.76715079,35.060967262,-117.767129003,35.060875005],
[-118.62603329638246,35.07451150670862,-118.62596597647176,35.074368286314204,-118.62599773249896,35.07443584653893,-118.62596597393961,35.0743682806039],
[-118.62596596092996,35.07436826040757,-118.6258868169483,35.074262253677404,-118.62593886586932,35.074331968825355,-118.625886813189,35.07426224893238],
[-118.13180200000001,35.07158399791231,-118.13177400001663,35.07004900682381,-118.131802,35.071583998,-118.13180199998337,35.071583996176145],
[-117.8654270643587,35.07262652901446,-117.8476665346599,35.072560986085605,-117.859112937,35.072603228,-117.847666535,35.072560986],
[-118.61114698024187,35.07964099907706,-118.61110092345442,35.079641711011945,-118.61113654346724,35.079641160406005,-118.61110082877615,35.07964171248106],
[-118.22464099704207,35.082568998442596,-118.22455500125777,35.08251700057301,-118.22464099213866,35.08256899485275,-118.22458030679445,35.08253230178269],
[-117.7747089927178,35.08761199954637,-117.77450600580124,35.087599000000004,-117.77470898935549,35.08761199931833,-117.77450600788853,35.08759900050517],
[-117.73754299922602,35.087453000000004,-117.73577000145121,35.08746099999899,-117.73754299913361,35.087453000003904,-117.73577000085005,35.08746099999616],
[-118.5563269936455,35.09115200121034,-118.5561880070705,35.09117199871755,-118.55632698615572,35.09115200199198,-118.5561880167014,35.091171997596916],
[-119.40071499734916,35.093520000031255,-119.39884900088347,35.09354199998958,-119.40071499482109,35.09352000000695,-119.3988490004105,35.093542],
[-119.3760270914543,35.09386852055761,-119.37487200245569,35.09399099955747,-119.37602709115082,35.093868520507286,-119.37487200776772,35.093990999176356],
[-118.97952599990809,35.09396199971069,-118.97948311034715,35.09382698820543,-118.97948311060483,35.09382698964775,-118.97948311030655,35.09382698772357],
[-118.97948311034715,35.09382698820543,-118.9793840070262,35.09351502211767,-118.97948311030655,35.09382698772357,-118.97938400397639,35.09351501298006],
[-118.97938299290227,35.09351397719775,-118.97928300066971,35.09320100185983,-118.9793829870734,35.0935139433324,-118.97938297293489,35.09351391528618],
[-118.55558999106377,35.0933080048955,-118.5554750039093,35.093370997858386,-118.55547500472144,35.093370997442676,-118.55547499872145,35.09337100044268],
[-118.53705169229859,35.102099016991566,-118.53682200029859,35.10210199999157,-118.53705169228802,35.102099016983274,-118.53682200015879,35.10210199999794],
[-118.476911,35.109623003,-118.47689,35.109927998,-118.47691099956434,35.10962300632761,-118.47689000021595,35.109927996863675],
[-118.4918806321448,35.110108192629234,-118.49121600892703,35.11091398925605,-118.491216019,35.110913977,-118.491216008,35.110913993],
[-118.47674899540583,35.11196899103759,-118.47668800419159,35.11185000817703,-118.476748991,35.111968982,-118.476688008,35.111850016],
[-118.23875699972774,35.111653000397006,-118.23875699770761,35.111653000856954,-118.23875699889838,35.11165300052907,-118.23851871164857,35.11176744111615],
[-118.1838359998294,35.11274200173469,-118.18381783671997,35.11292668211018,-118.18383599948015,35.11274200521237,-118.18369900048357,35.114135000177534],
[-118.4059059991709,35.12282799978398,-118.40536099999642,35.12268599999896,-118.4059059982132,35.122827999230715,-118.40536100028305,35.12268600024891],
[-119.07531099977574,35.12757601365974,-119.07530000026078,35.12824598411612,-119.075300001,35.128245968,-119.075299998,35.128245989],
[-118.48597899999979,35.12873499889178,-118.48592100084552,35.12832800882644,-118.485921001,35.128328003,-118.485921001,35.12832801],
[-118.20205499999511,35.12663299201237,-118.202051,35.12622800350588,-118.20205262400488,35.126392392987896,-118.20205100000489,35.126228010987894],
[-118.46639574551371,35.135452169229545,-118.46624604493408,35.135424791656504,-118.46631408000955,35.13543723436841,-118.46624604400955,35.13542479136841],
[-118.17036555018419,35.135240662057484,-118.17022243419044,35.13539898805056,-118.17036554981577,35.13524066194256,-118.17021700350637,35.135404996072296],
[-119.458467000125,35.13683399999908,-119.45705900010286,35.13684599999912,-119.45846699989288,35.13683400000091,-119.45705899989126,35.136846000001036],
[-118.41857390097006,35.138789063979395,-118.41415034497015,35.138699249979396,-118.41415036522085,35.13869925084334,-118.41415035834585,35.13869924978781],
[-118.20128398058887,35.13837298017855,-118.20120501058886,35.13829201117856,-118.20128398041147,35.138372979821796,-118.20124888641085,35.13833699782117],
[-118.19994117650039,35.139216645001206,-118.19991782050039,35.13922925200121,-118.19994117561791,35.13921664547471,-118.1999267984972,35.13922440600009],
[-118.476538,35.141670999,-118.476537999,35.141670998,-118.47653799953574,35.14167099885898,-118.47647900217716,35.14152600535064],
[-118.45564099996285,35.139796000234675,-118.45544100855568,35.14105994592811,-118.455640997,35.139796015649885,-118.455640997,35.139796022137446],
[-117.74661499920998,35.141117000009956,-117.74423400103184,35.141146999986994,-117.74661499874013,35.14111700000794,-117.74423400137003,35.141147],
[-118.74111499607962,35.14595200055435,-118.74079300620133,35.14601499913923,-118.74111499503152,35.145952000972095,-118.74079300311716,35.14601499939012],
[-118.67566899991502,35.14408502001375,-118.67561900001091,35.147469999523054,-118.6756689989891,35.144085114476965,-118.67566899478264,35.14408508426524],
[-118.50722913307025,35.14598890426933,-118.50706998857478,35.14601072377772,-118.50722913258377,35.145988904073114,-118.50706998858685,35.14601072407269],
[-118.493545998,35.144299001,-118.493294003,35.144370999,-118.49354599524457,35.14429900135869,-118.49329400651891,35.14437099813746],
[-119.5149889996281,35.149130997600444,-119.51486000341662,35.1490020013889,-119.51486000574022,35.149002003712624,-119.51485999710266,35.149001993861276],
[-118.990828411,35.149139328,-118.990220012,35.149494993,-118.990220024,35.149494986,-118.990220007,35.149494994],
[-118.272913,35.15230499859516,-118.2728570000073,35.14759900020926,-118.272913,35.152304998,-118.272857,35.147599],
[-118.1883591361792,35.14721643886591,-118.18813200117881,35.147385998866206,-118.18813200475839,35.1473859960498,-118.18813199847007,35.147386001205],
[-118.68986799053374,35.151554995522716,-118.689646003431,35.15145000162276,-118.68986798175573,35.15155499060117,-118.68964600774378,35.15145000406849],
[-118.68791699995195,35.15080401499274,-118.68791600003173,35.1511159900964,-118.6879160013606,35.151115996439955,-118.68791600000051,35.15111597967946],
[-118.16951999304553,35.15182700231626,-118.16938658778825,35.15186863846025,-118.16951998820664,35.15182700354134,-118.16943768320664,35.15185269154134],
[-118.63720199785969,35.155133998505725,-118.63703000186698,35.15495100151348,-118.637201995,35.155133995,-118.637030006,35.154951006],
[-118.14901199928944,35.16080000028919,-118.14901199733107,35.16080000322008,-118.14901199926105,35.16080000115747,-118.1488150562612,35.160994463157316],
[-117.98584699997436,35.15512201952792,-117.98583400000194,35.15803699934278,-117.98584699954655,35.15512210167759,-117.98583399999913,35.15803699999676],
[-118.70037244754914,35.16525155932461,-118.70024889085178,35.15117969376051,-118.70037244699614,35.165251559122,-118.700248891,35.15117969456061],
[-118.63152599755556,35.16955299999901,-118.63130099955555,35.169551999999015,-118.63152599322224,35.169553,-118.63130100053424,35.16955200000138],
[-118.13921899457138,35.16943401273487,-118.13913627955205,35.16962226022713,-118.13921898844798,35.16943402577282,-118.13913200556487,35.16963198795502],
[-117.94407399989707,35.1695859999991,-117.94384599912377,35.169584,-117.94407399982575,35.1695860000034,-117.94384600087716,35.16958400000385],
[-118.57718398269925,35.17497098588753,-118.57626315819027,35.17420013232139,-118.5771838328097,35.174970860678584,-118.57626301657866,35.17420001350799],
[-118.48185699911005,35.175642997912114,-118.48163000395014,35.17529000621851,-118.48185699601039,35.17564299379589,-118.48163000879991,35.175290013684446],
[-118.47848599593762,35.17202899332939,-118.47831000369867,35.1717400060734,-118.47848599589709,35.17202899386278,-118.47831000140852,35.17174000198668],
[-118.50180599074923,35.177427993750946,-118.5017420057111,35.17738700328902,-118.501805982,35.177427988,-118.501742014,35.177387009],
[-119.555783998,35.182626002,-119.555783992,35.182626006,-119.555783996,35.182626003,-119.555621138,35.182754194],
[-118.66499309823814,35.185748008001966,-118.66368567844479,35.18547651742854,-118.664993098,35.185748008,-118.663685678,35.185476517],
[-118.697877437,35.188619438,-118.695797165,35.188792248,-118.69787743659153,35.18861943809128,-118.69579716488761,35.18879224784081],
[-118.843803991,35.21156929,-118.843795826,35.209180953,-118.84379582928379,35.20918101879407,-118.843795826038,35.20918104440921],
[-118.07925237420562,35.21409104348862,-118.07915700020592,35.21417899948834,-118.07915700181528,35.21417899764767,-118.07915699971885,35.21417900064792],
[-119.43440698401957,35.220992005595065,-119.43309601734113,35.221449992735984,-119.43309603383776,35.2214499872617,-119.43309601170401,35.22144999226678],
[-118.07410999516813,35.21883600432798,-118.07388249558068,35.21906920982985,-118.07409902341652,35.21884725217303,-118.07379100041922,35.219162999170265],
[-118.67278376140752,35.22385855017084,-118.67062200925415,35.223917931037704,-118.67278369919376,35.22385854904562,-118.67278367494005,35.22385855272175],
[-119.34094599996999,35.22848000144976,-119.34091996497,35.229542438449705,-119.340945999955,35.22848000183651,-119.3409310239031,35.22909115220985],
[-118.67953500009149,35.23816499999787,-118.67774200034751,35.23820499999224,-118.6795349998955,35.23816500000233,-118.67774199999918,35.238204999999404],
[-118.84561175000218,35.24551399908526,-118.84259486240337,35.2455159990107,-118.84266636293374,35.24551595200002,-118.84259625093439,35.24551599800002],
[-118.05758299708798,35.25043100316377,-118.05738900013786,35.25064500010875,-118.05758299691217,35.25043100383606,-118.05738899991218,35.25064499983606],
[-118.057287638,35.250757090081,-118.05728586900011,35.24956300414815,-118.05728763799989,35.25075708985185,-118.0572876121821,35.250757157059795],
[-119.02186499999871,35.262975000004154,-119.02169900051963,35.26297400000313,-119.02186499908619,35.2629749999945,-119.0216989993991,35.262974],
[-119.02124898018651,35.262335872362584,-119.0212010005519,35.26203400466142,-119.02124897981756,35.26233587301877,-119.02120100323077,35.26203402032693],
[-118.65863599999552,35.264311000048224,-118.65821821494684,35.2642805865287,-118.65863599873961,35.26431099973608,-118.65821821473962,35.264280586736085],
[-118.6279289968176,35.26383299945878,-118.62776346185677,35.263804847254555,-118.6279289918074,35.26383299834187,-118.6277634622339,35.263804847584474],
[-117.74506100037432,35.264327999750456,-117.74485500095467,35.264463999369724,-117.74506100009532,35.26432800045362,-117.7448550020953,35.264463998453614],
[-119.518852357,35.267438048,-119.518852356,35.267438056,-119.51885235699797,35.26743804837312,-119.51876760092323,35.25733225790552],
[-119.12832999997697,35.267231018949666,-119.1283297169992,35.267301690399826,-119.12832999992109,35.26723101973485,-119.12832971735602,35.267301690234845],
[-119.06751924580975,35.26704380488731,-119.06694200002947,35.26704100000014,-119.06751924551408,35.26704380499882,-119.06694200047154,35.2670409999986],
[-119.06354100008487,35.26702500000041,-119.06331851784816,35.267024076837544,-119.06333784358605,35.26702415699914,-119.06331851758588,35.26702407699914],
[-119.03896500000069,35.26518799962754,-119.03895900002006,35.266906981075984,-119.03896499999937,35.265188000357426,-119.03895900002007,35.26690698042387],
[-118.62741100000181,35.26374099988974,-118.62734300034309,35.26758998057964,-118.62734300198439,35.26758988976643,-118.62734299778263,35.26758991673478],
[-119.03674078102608,35.272033258283884,-119.03672700017452,35.2714300197817,-119.0367270025129,35.271430110000416,-119.03672699865126,35.27143008467211],
[-118.9012360000287,35.27011500014817,-118.90075600412895,35.270423998083636,-118.901236,35.270115,-118.901235999,35.270115001],
[-118.75260300000001,35.27059699925365,-118.75258900000125,35.26781101250251,-118.75260299999874,35.270597000004784,-118.75258900003104,35.26781100617424],
[-118.38361799151959,35.27190699749858,-118.3834790072952,35.271866002151825,-118.38347901429144,35.27186600408548,-118.38347900561163,35.27186600194193],
[-119.06920600042253,35.274297000000885,-119.06887209545373,35.274295485001026,-119.06920599993957,35.27429699999973,-119.06887209521693,35.274295484547125],
// [-119.05284689982335,35.27359599953262,-119.05242829495646,35.27359404647724,-119.05284689946711,35.27359600000109,-119.0526846284671,35.27359524200109],
[-118.717063,35.27790253041,-118.71703879259,35.26767059644,-118.71706299996795,35.277902517335846,-118.71703879299973,35.267670596763416],
[-118.05778766087026,35.27493222837427,-118.05771131202542,35.27154657825448,-118.05778765897459,35.27493213274551,-118.05778765705806,35.27493215461168],
[-117.81386246507242,35.272501153994256,-117.80930801802796,35.27254999993038,-117.8138624647275,35.27250115423804,-117.8093080963644,35.27254999896651],
[-118.40767899645066,35.28109699854499,-118.40751800789194,35.28103100323521,-118.40751801593062,35.28103100647288,-118.40751800431178,35.28103100252363],
[-119.04615634199564,35.285052527335516,-119.045955302623,35.2850517288188,-119.04615634160307,35.28505252699921,-119.04595530260305,35.285051728999214],
[-119.03709882627665,35.284921779000385,-119.03689762222116,35.284921334000245,-119.037098826,35.284921779,-119.036897623,35.284921334],
[-117.902613994,35.791330009,-117.902283002,35.791835997,-117.90228300418406,35.79183599360383,-117.90228300150606,35.79183599793448]];
      data.forEach(compare);
    })


  });

})
